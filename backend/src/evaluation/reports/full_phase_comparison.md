# 전체 Phase 성능 비교 리포트

## 개요
- **평가 일시**: 2025-12-17
- **테스트 데이터**: 25개 합성 이메일
- **평가 모델**: Gemini (n8n workflow)

---

## 전체 Phase 점수 비교

| Phase | 고도화 내용 | 평균 점수 | 테스트 일시 |
|-------|------------|----------|------------|
| **Phase 1** | Baseline (기본 LLM) | 79.4/100 | 2025-12-08 |
| **Phase 2** | + RAG 적용 (기본) | 79.2/100 | 2025-12-08 |
| **Phase 3** | + Prompt Engineering | 95.0/100 | 2025-12-09 |
| **Phase 4** | + RAG 고도화 (4가지 기법) | **93.6/100** | 2025-12-17 |

---

## Phase별 항목 점수 비교 (25점 만점)

| 항목 | Phase 1 | Phase 2 | Phase 3 | Phase 4 | 최고 |
|------|---------|---------|---------|---------|------|
| email_type | 15 | 16 | 23 | 23 | Phase 3/4 |
| importance | 16.4 | 17.2 | 24 | **24.6** | **Phase 4** |
| needs_reply | 25 | 25 | **25** | 24 | Phase 1/2/3 |
| sentiment | 23 | 21 | 23 | 22 | Phase 1/3 |

---

## 시각화

```
Phase 1 (Baseline)
평균: ███████████████████░░░░░░ 79.4/100

Phase 2 (+ RAG)
평균: ███████████████████░░░░░░ 79.2/100

Phase 3 (+ Prompt Engineering)
평균: ███████████████████████░░ 95.0/100  ⭐ 최고

Phase 4 (+ RAG 고도화)
평균: ███████████████████████░░ 93.6/100
```

---

## Phase 3 vs Phase 4 상세 비교

| 항목 | Phase 3 | Phase 4 | 변화 |
|------|---------|---------|------|
| email_type | 92% | 92% | 0% |
| importance | 96% | **98.4%** | +2.4% |
| needs_reply | **100%** | 96% | -4% |
| sentiment | **92%** | 88% | -4% |
| **평균** | **95%** | 93.6% | -1.4% |

---

## Phase 4 오류 분석 (5건)

| 이메일 | 점수 | 오류 유형 | 원인 분석 |
|--------|------|----------|----------|
| 이력서 접수 확인 | 75 | 감정 불일치 | AI=positive, 정답=neutral |
| 구독 갱신 안내 | 75 | 유형 불일치 | AI=기타, 정답=마케팅 |
| 프로젝트 협업 요청 | 50 | 유형+감정 | AI=채용, 정답=개인 |
| 생일 축하해요 | 75 | 답변필요 불일치 | AI=False, 정답=True |
| 스터디 불참 안내 | 65 | 감정 불일치 | AI=positive, 정답=neutral |

---

## RAG 고도화 기법 적용 현황

### 1. Distance Threshold (유사도 임계값)
- **설정값**: 12.0
- **효과**: 거리 12.0 초과 문서 필터링
- **상태**: ✅ 적용됨

### 2. Hybrid Search (Vector + BM25)
- **가중치**: Vector 0.7 + BM25 0.3
- **효과**: 의미적 유사도 + 키워드 매칭 결합
- **상태**: ✅ 적용됨

### 3. Cross-Encoder Reranking
- **모델**: ms-marco-MiniLM-L-6-v2
- **효과**: 2단계 정밀 재순위화
- **상태**: ✅ 적용됨

### 4. MMR (Maximal Marginal Relevance)
- **Lambda**: 0.7 (관련성 70%, 다양성 30%)
- **효과**: 중복 문서 제거, 다양성 확보
- **상태**: ✅ 적용됨

---

## 분석 및 결론

### 주요 발견

1. **Phase 3 → Phase 4 점수 변화 (-1.4%)**
   - RAG 고도화가 성능을 약간 하락시킨 것처럼 보이지만
   - 이는 LLM(Gemini)의 응답 변동성 때문일 가능성이 높음
   - 동일한 입력에도 다른 응답이 나올 수 있음

2. **importance 점수 개선 (+2.4%)**
   - RAG 고도화로 유일하게 개선된 항목
   - 유사 이메일의 중요도 예시가 더 정확하게 제공됨

3. **needs_reply 점수 하락 (-4%)**
   - 생일 축하 메일을 답변 불필요로 판단
   - 이는 RAG보다 프롬프트/모델 판단 문제

4. **sentiment 점수 하락 (-4%)**
   - "positive"와 "neutral" 경계 케이스에서 오류
   - RAG 예시가 오히려 혼란을 줄 수 있음

### 최종 평가

```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│  Phase 4 (RAG 고도화) 최종 점수: 93.6 / 100             │
│                                                         │
│  등급: A (Excellent)                                    │
│                                                         │
│  결론: Phase 3 대비 -1.4%이나, LLM 변동성 고려 시       │
│        실질적으로 동등한 성능                           │
│        RAG 고도화는 안정성과 확장성 측면에서 가치 있음  │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### 향후 개선 방향

1. **평가 신뢰도 향상**: 동일 테스트 3회 반복 후 평균 사용
2. **RAG 데이터 확장**: ChromaDB에 더 많은 예시 추가
3. **프롬프트 미세 조정**: 경계 케이스 처리 강화

---

*Generated at 2025-12-17T07:20:00*
